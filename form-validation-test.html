<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡¨å•éªŒè¯ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        .fix-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #28a745;
        }
        
        .success {
            border-left-color: #28a745;
            background: #d4edda;
            color: #155724;
        }
        
        .info {
            border-left-color: #17a2b8;
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .warning {
            border-left-color: #ffc107;
            background: #fff3cd;
            color: #856404;
        }
        
        .code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .step {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }
        
        .step-number {
            display: inline-block;
            background: #28a745;
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            text-align: center;
            line-height: 28px;
            margin-right: 12px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 4px;
            color: #856404;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <h1>ğŸ¯ è¡¨å•éªŒè¯é—®é¢˜ä¿®å¤å®Œæˆ</h1>
    
    <div class="fix-section success">
        <h3>âœ… é—®é¢˜å·²è§£å†³ï¼</h3>
        <p><strong>æ ¸å¿ƒé—®é¢˜ï¼š</strong>è¡¨å•éªŒè¯è§„åˆ™è¦æ±‚<code>icon</code>å­—æ®µå¿…å¡«ï¼Œä½†ç”¨æˆ·é€‰æ‹©è‡ªå®šä¹‰å›¾ç‰‡æ—¶ä¼šæ¸…ç©ºè¯¥å­—æ®µã€‚</p>
        <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ä½¿ç”¨è‡ªå®šä¹‰éªŒè¯å‡½æ•°ï¼Œç¡®ä¿è‡³å°‘é€‰æ‹©äº†emojiå›¾æ ‡æˆ–è‡ªå®šä¹‰å›¾æ ‡ä¸­çš„ä¸€ç§ã€‚</p>
    </div>

    <div class="fix-section info">
        <h3>ğŸ” é—®é¢˜åˆ†æ</h3>
        
        <div class="step">
            <span class="step-number">1</span>
            <strong>å‘ç°éªŒè¯å¤±è´¥</strong>
            <p>æ§åˆ¶å°é”™è¯¯æ˜¾ç¤º"è¡¨å•éªŒè¯å¤±è´¥"ï¼Œè¯´æ˜Element Plusçš„è¡¨å•éªŒè¯é˜»æ­¢äº†ä¿å­˜æ“ä½œã€‚</p>
            <div class="code">
// åŸéªŒè¯è§„åˆ™ï¼ˆæœ‰é—®é¢˜çš„ï¼‰
icon: [
  { required: true, message: 'è¯·é€‰æ‹©ä¸“åŒºå›¾æ ‡', trigger: 'change' }
]

// é—®é¢˜ï¼šå½“ç”¨æˆ·ä¸Šä¼ è‡ªå®šä¹‰å›¾ç‰‡æ—¶
zoneForm.icon = ''        // âŒ æ¸…ç©ºäº†ï¼Œå¯¼è‡´éªŒè¯å¤±è´¥
zoneForm.customIcon = 'data:image/png;base64,xxx' // âœ… æœ‰æ•°æ®ä½†ä¸è¢«éªŒè¯
            </div>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>è®¾è®¡æ–°çš„éªŒè¯ç­–ç•¥</strong>
            <p>æ—¢ç„¶ç”¨æˆ·å¯ä»¥é€‰æ‹©emojiå›¾æ ‡æˆ–è‡ªå®šä¹‰å›¾æ ‡ï¼ŒéªŒè¯é€»è¾‘åº”è¯¥å…è®¸å…¶ä¸­ä»»æ„ä¸€ç§ã€‚</p>
            <div class="code">
// æ–°çš„è‡ªå®šä¹‰éªŒè¯å‡½æ•°
const validateIcon = (rule, value, callback) => {
  const hasEmojiIcon = zoneForm.icon && zoneForm.icon.trim() !== ''
  const hasCustomIcon = zoneForm.customIcon && zoneForm.customIcon.trim() !== ''
  
  if (!hasEmojiIcon && !hasCustomIcon) {
    callback(new Error('è¯·é€‰æ‹©emojiå›¾æ ‡æˆ–ä¸Šä¼ è‡ªå®šä¹‰å›¾æ ‡'))
  } else {
    callback() // éªŒè¯é€šè¿‡
  }
}
            </div>
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>åº”ç”¨æ–°éªŒè¯è§„åˆ™</strong>
            <div class="code">
// ä¿®å¤åçš„éªŒè¯è§„åˆ™
icon: [
  { validator: validateIcon, trigger: 'change' }
]
            </div>
            <p>ä½¿ç”¨<code>validator</code>æ›¿ä»£ç®€å•çš„<code>required</code>è§„åˆ™ï¼Œå®ç°æ›´çµæ´»çš„éªŒè¯é€»è¾‘ã€‚</p>
        </div>

        <div class="step">
            <span class="step-number">4</span>
            <strong>æ‰‹åŠ¨è§¦å‘éªŒè¯æ›´æ–°</strong>
            <p>å½“ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡æˆ–é€‰æ‹©emojiæ—¶ï¼Œæ‰‹åŠ¨è§¦å‘è¡¨å•éªŒè¯ä»¥å®æ—¶æ›´æ–°çŠ¶æ€ã€‚</p>
            <div class="code">
// å›¾ç‰‡ä¸Šä¼ æˆåŠŸå
ElMessage.success('å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ç°åœ¨å¯ä»¥ä¿å­˜äº†')
if (zoneFormRef.value) {
  zoneFormRef.value.validateField('icon') // ğŸ”„ é‡æ–°éªŒè¯iconå­—æ®µ
}

// emojié€‰æ‹©å
const selectEmojiIcon = (icon) => {
  zoneForm.icon = icon
  zoneForm.customIcon = ''
  iconType.value = 'emoji'
  
  if (zoneFormRef.value) {
    zoneFormRef.value.validateField('icon') // ğŸ”„ é‡æ–°éªŒè¯iconå­—æ®µ
  }
}
            </div>
        </div>
    </div>

    <div class="fix-section">
        <h3>ğŸ› ï¸ å®Œæ•´ä¿®å¤å†…å®¹</h3>
        
        <h4>1. è‡ªå®šä¹‰éªŒè¯å‡½æ•°</h4>
        <div class="code">
const validateIcon = (rule, value, callback) => {
  console.log('éªŒè¯å›¾æ ‡:', {
    iconType: iconType.value,
    icon: zoneForm.icon,
    customIcon: zoneForm.customIcon ? 'æœ‰æ•°æ®' : 'æ— æ•°æ®',
    customIconLength: zoneForm.customIcon ? zoneForm.customIcon.length : 0
  })
  
  // æ£€æŸ¥æ˜¯å¦æœ‰emojiå›¾æ ‡æˆ–è‡ªå®šä¹‰å›¾æ ‡
  const hasEmojiIcon = zoneForm.icon && zoneForm.icon.trim() !== ''
  const hasCustomIcon = zoneForm.customIcon && zoneForm.customIcon.trim() !== ''
  
  if (!hasEmojiIcon && !hasCustomIcon) {
    console.error('å›¾æ ‡éªŒè¯å¤±è´¥ï¼šæ—¢æ²¡æœ‰emojiå›¾æ ‡ä¹Ÿæ²¡æœ‰è‡ªå®šä¹‰å›¾æ ‡')
    callback(new Error('è¯·é€‰æ‹©emojiå›¾æ ‡æˆ–ä¸Šä¼ è‡ªå®šä¹‰å›¾æ ‡'))
  } else {
    console.log('å›¾æ ‡éªŒè¯é€šè¿‡')
    callback()
  }
}
        </div>

        <h4>2. æ›´æ–°éªŒè¯è§„åˆ™</h4>
        <div class="code">
const zoneRules = {
  name: [
    { required: true, message: 'è¯·è¾“å…¥ä¸“åŒºåç§°', trigger: 'blur' },
    { min: 2, max: 20, message: 'åç§°é•¿åº¦åœ¨ 2 åˆ° 20 ä¸ªå­—ç¬¦', trigger: 'blur' }
  ],
  icon: [
    { validator: validateIcon, trigger: 'change' } // âœ… ä½¿ç”¨è‡ªå®šä¹‰éªŒè¯
  ],
  description: [
    { required: true, message: 'è¯·è¾“å…¥ä¸“åŒºæè¿°', trigger: 'blur' },
    { max: 100, message: 'æè¿°ä¸èƒ½è¶…è¿‡100ä¸ªå­—ç¬¦', trigger: 'blur' }
  ]
}
        </div>

        <h4>3. å®æ—¶éªŒè¯è§¦å‘</h4>
        <div class="code">
// å›¾ç‰‡ä¸Šä¼ æˆåŠŸåè§¦å‘éªŒè¯
reader.onload = (e) => {
  // ...å¤„ç†å›¾ç‰‡æ•°æ®...
  
  ElMessage.success('å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ç°åœ¨å¯ä»¥ä¿å­˜äº†')
  
  // æ‰‹åŠ¨è§¦å‘è¡¨å•éªŒè¯æ›´æ–°
  if (zoneFormRef.value) {
    console.log('æ‰‹åŠ¨è§¦å‘iconå­—æ®µéªŒè¯...')
    zoneFormRef.value.validateField('icon')
  }
}

// emojié€‰æ‹©åè§¦å‘éªŒè¯
const selectEmojiIcon = (icon) => {
  console.log('é€‰æ‹©emojiå›¾æ ‡:', icon)
  zoneForm.icon = icon
  zoneForm.customIcon = ''
  iconType.value = 'emoji'
  
  // æ‰‹åŠ¨è§¦å‘è¡¨å•éªŒè¯æ›´æ–°
  if (zoneFormRef.value) {
    console.log('æ‰‹åŠ¨è§¦å‘iconå­—æ®µéªŒè¯...')
    zoneFormRef.value.validateField('icon')
  }
}
        </div>
    </div>

    <div class="fix-section warning">
        <h3>ğŸ“‹ æµ‹è¯•æ­¥éª¤</h3>
        <ol>
            <li>è¿›å…¥ç®¡ç†åå° â†’ ä¸“åŒºç®¡ç† â†’ ç¼–è¾‘ä¸“åŒºæˆ–åˆ›å»ºä¸“åŒº</li>
            <li>å¡«å†™å¿…è¦ä¿¡æ¯ï¼ˆåç§°ã€æè¿°ï¼‰</li>
            <li>æµ‹è¯•åœºæ™¯1ï¼š<span class="highlight">é€‰æ‹©emojiå›¾æ ‡</span> â†’ ç‚¹å‡»ä¿å­˜ â†’ åº”è¯¥æˆåŠŸ</li>
            <li>æµ‹è¯•åœºæ™¯2ï¼š<span class="highlight">ä¸Šä¼ è‡ªå®šä¹‰å›¾ç‰‡</span> â†’ ç‚¹å‡»ä¿å­˜ â†’ åº”è¯¥æˆåŠŸ</li>
            <li>æµ‹è¯•åœºæ™¯3ï¼š<span class="highlight">æ—¢ä¸é€‰emojiä¹Ÿä¸ä¸Šä¼ å›¾ç‰‡</span> â†’ ç‚¹å‡»ä¿å­˜ â†’ åº”è¯¥æç¤º"è¯·é€‰æ‹©emojiå›¾æ ‡æˆ–ä¸Šä¼ è‡ªå®šä¹‰å›¾æ ‡"</li>
            <li>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†çš„éªŒè¯æ—¥å¿—</li>
        </ol>
    </div>

    <div class="fix-section success">
        <h3>ğŸ‰ é¢„æœŸç»“æœ</h3>
        <ul>
            <li>âœ… ä¸Šä¼ å›¾ç‰‡åå¯ä»¥æ­£å¸¸ä¿å­˜</li>
            <li>âœ… é€‰æ‹©emojiå›¾æ ‡åå¯ä»¥æ­£å¸¸ä¿å­˜</li>
            <li>âœ… æ²¡æœ‰é€‰æ‹©ä»»ä½•å›¾æ ‡æ—¶ä¼šæ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º</li>
            <li>âœ… æ§åˆ¶å°æ˜¾ç¤ºè¯¦ç»†çš„éªŒè¯è¿‡ç¨‹æ—¥å¿—</li>
            <li>âœ… è¡¨å•éªŒè¯ä¸å†é˜»æ­¢ä¿å­˜æ“ä½œ</li>
            <li>âœ… ä¸“åŒºæ•°æ®æ­£ç¡®ä¿å­˜åˆ°localStorage</li>
            <li>âœ… é¡µé¢åˆ·æ–°åè‡ªå®šä¹‰å›¾æ ‡æ­£å¸¸æ˜¾ç¤º</li>
        </ul>
    </div>

    <div class="fix-section info">
        <h3>ğŸ”¬ è°ƒè¯•ä¿¡æ¯</h3>
        <p>åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸‹è°ƒè¯•ä¿¡æ¯ï¼š</p>
        <ul>
            <li><code>éªŒè¯å›¾æ ‡: {iconType: "custom", icon: "", customIcon: "æœ‰æ•°æ®", ...}</code></li>
            <li><code>å›¾æ ‡éªŒè¯é€šè¿‡</code> æˆ– <code>å›¾æ ‡éªŒè¯å¤±è´¥ï¼š...</code></li>
            <li><code>æ‰‹åŠ¨è§¦å‘iconå­—æ®µéªŒè¯...</code></li>
            <li><code>è¡¨å•éªŒè¯ç»“æœ: true</code></li>
        </ul>
        
        <h4>å¦‚æœä»ç„¶æœ‰é—®é¢˜ï¼š</h4>
        <div class="code">
// åœ¨æ§åˆ¶å°è¿è¡Œè¿™ä¸ªå‘½ä»¤æ£€æŸ¥å½“å‰è¡¨å•çŠ¶æ€
console.log('å½“å‰è¡¨å•æ•°æ®:', {
  name: zoneForm?.name,
  icon: zoneForm?.icon,
  customIcon: zoneForm?.customIcon ? 'æœ‰æ•°æ®' : 'æ— æ•°æ®',
  iconType: iconType?.value
})
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ¯ è¡¨å•éªŒè¯ä¿®å¤æµ‹è¯•é¡µé¢å·²åŠ è½½');
            
            // æ·»åŠ é¡µé¢åŠ¨ç”»
            const sections = document.querySelectorAll('.fix-section');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                section.style.transition = 'all 0.6s ease';
                
                setTimeout(() => {
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 150);
            });

            console.log('ğŸ“‹ ä¿®å¤å†…å®¹æ€»ç»“:');
            console.log('1. âœ… ç§»é™¤äº†iconå­—æ®µçš„ç®€å•requiredéªŒè¯');
            console.log('2. âœ… æ·»åŠ äº†è‡ªå®šä¹‰validateIconå‡½æ•°');
            console.log('3. âœ… åœ¨å›¾ç‰‡ä¸Šä¼ å’Œemojié€‰æ‹©åæ‰‹åŠ¨è§¦å‘éªŒè¯');
            console.log('4. âœ… å¢åŠ äº†è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—');
            console.log('');
            console.log('ç°åœ¨å›¾ç‰‡ä¸Šä¼ å’Œä¿å­˜åº”è¯¥å®Œå…¨æ­£å¸¸äº†ï¼');
        });
    </script>
</body>
</html>